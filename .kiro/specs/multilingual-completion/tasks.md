# 多语言功能修复实施计划

## 任务列表

- [ ] 1. 修复语言切换器组件
  - [x] 1.1 分析当前LanguageSwitcher组件的路径处理逻辑
    - 检查当前changeLanguage函数的实现
    - 识别路径构建中的问题
    - 分析pathname解析逻辑
    - _需求: 1.1, 4.1_

  - [x] 1.2 实现正确的路径解析功能
    - 创建路径解析工具函数parseCurrentPath
    - 实现语言前缀检测和移除逻辑
    - 处理首页和子页面的不同情况
    - _需求: 1.2, 4.2_

  - [x] 1.3 实现正确的目标路径构建功能
    - 创建buildTargetPath工具函数
    - 实现英语默认语言的特殊处理
    - 确保子页面路径正确保持
    - _需求: 1.3, 4.3_

  - [x] 1.4 添加错误处理和用户体验优化
    - 添加语言切换的加载状态
    - 实现错误处理和重试机制
    - 防止重复点击和并发切换
    - _需求: 5.1, 5.2_

- [ ] 2. 修复首页子页面导航组件
  - [x] 2.1 分析SubPageNavigation组件的链接构建
    - 检查当前href构建逻辑
    - 识别多语言路径处理的缺陷
    - 分析locale参数的使用
    - _需求: 2.1, 4.1_

  - [x] 2.2 实现统一的链接构建逻辑
    - 创建buildPageHref工具函数
    - 确保所有子页面链接正确包含语言前缀
    - 处理英语默认语言的特殊情况
    - _需求: 2.2, 2.3, 4.2_

  - [x] 2.3 测试所有子页面的导航功能
    - 验证每个语言环境下的链接正确性
    - 测试所有子页面的跳转功能
    - 确保导航在不同语言间的一致性
    - _需求: 2.4, 4.3_

- [ ] 3. 修复子页面SEO区域显示问题
  - [x] 3.1 检查翻译文件的完整性
    - 分析所有语言文件中的SEO相关翻译
    - 识别缺失或不完整的翻译键
    - 检查aria-label和其他SEO属性的翻译
    - _需求: 3.1, 3.2_

  - [x] 3.2 实现翻译回退机制
    - 创建getTranslationWithFallback工具函数
    - 实现英语作为回退语言的逻辑
    - 处理翻译键名显示的问题
    - _需求: 3.3, 5.3_

  - [x] 3.3 修复子页面组件的翻译使用
    - 更新所有子页面的aria-label翻译调用
    - 确保SEO相关组件使用回退机制
    - 验证结构化数据的正确本地化
    - _需求: 3.4, 5.4_

- [ ] 4. 创建统一的路径处理工具
  - [x] 4.1 创建路径处理工具文件
    - 创建lib/pathUtils.ts文件
    - 定义路径处理相关的TypeScript接口
    - 实现基础的路径解析函数
    - _需求: 4.1, 4.2_

  - [x] 4.2 实现核心路径处理函数
    - 实现parsePathInfo函数解析当前路径
    - 实现buildLocalizedPath函数构建本地化路径
    - 实现validatePath函数验证路径有效性
    - _需求: 4.3, 5.4_

  - [x] 4.3 集成路径工具到现有组件
    - 更新LanguageSwitcher使用新的路径工具
    - 更新SubPageNavigation使用统一的路径构建
    - 确保所有组件使用一致的路径处理逻辑
    - _需求: 1.4, 2.4, 4.4_

- [ ] 5. 综合测试和验证
  - [x] 5.1 功能测试
    - 测试所有语言的页面切换功能
    - 验证首页导航链接的正确性
    - 检查子页面SEO内容的显示
    - _需求: 1.4, 2.4, 3.4_

  - [x] 5.2 用户体验测试
    - 测试语言切换的响应速度
    - 验证加载状态和错误提示
    - 检查不同设备和浏览器的兼容性
    - _需求: 5.1, 5.2_

  - [x] 5.3 回归测试
    - 确保修复不影响现有功能
    - 验证所有页面的正常加载
    - 检查SEO和性能指标
    - _需求: 5.3, 5.4_

- [ ] 6. 文档和维护
  - [x] 6.1 编写技术文档
    - 记录路径处理的设计决策
    - 创建多语言功能的使用指南
    - 编写故障排除文档
    - _需求: 5.4_

  - [x] 6.2 代码优化和清理
    - 优化路径处理的性能
    - 清理不必要的代码和注释
    - 确保代码符合项目规范
    - _需求: 5.1, 5.2_

- [ ] 7. 修复elf-name-randomizer页面翻译问题
  - [x] 7.1 分析randomizer页面翻译结构问题
    - 检查所有语言文件中的randomizerSeo和elfRandomizerSeo重复部分
    - 识别翻译内容质量和一致性问题
    - 分析页面显示的具体翻译错误
    - _需求: 3.1, 3.2_

  - [x] 7.2 清理和统一翻译键结构
    - 移除重复的翻译部分（randomizerSeo vs elfRandomizerSeo）
    - 统一使用randomizerSeo作为标准命名空间
    - 确保所有语言文件结构一致
    - _需求: 3.3, 3.4_

  - [x] 7.3 修复和完善翻译内容
    - 补全缺失的翻译内容
    - 修正不准确或不合适的翻译
    - 确保翻译内容符合页面上下文
    - _需求: 3.1, 3.4_

  - [x] 7.4 验证页面显示效果
    - 测试所有语言版本的randomizer页面
    - 确认翻译内容正确显示而非键名
    - 验证SEO区域的本地化效果
    - _需求: 3.2, 3.4_